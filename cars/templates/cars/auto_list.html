{% extends 'base.html' %}

{% block title %}Autos disponibles{% endblock %}

{% block content %}
<div class="container mt-4">
  <h1 class="fw-bold text-center mb-4">Autos disponibles üöó</h1>

  <!-- Formulario de b√∫squeda -->
  <form method="get" class="p-4 bg-light rounded shadow-sm mb-4">
    <div class="row g-3 align-items-end">
      <div class="col-md-3">
        <label class="form-label fw-semibold">Marca o modelo</label>
        <input 
          type="text" 
          name="q" 
          class="form-control" 
          placeholder="Ej: Ford, Virtus, etc." 
          value="{{ q }}"
        >
      </div>
      <div class="col-md-2">
        <label class="form-label fw-semibold">A√±o desde</label>
        <input 
          type="number" 
          name="anio_min" 
          class="form-control" 
          placeholder="Ej: 2010"
          value="{{ anio_min }}"
        >
      </div>
      <div class="col-md-2">
        <label class="form-label fw-semibold">A√±o hasta</label>
        <input 
          type="number" 
          name="anio_max" 
          class="form-control" 
          placeholder="Ej: 2025"
          value="{{ anio_max }}"
        >
      </div>
      <div class="col-md-2">
        <label class="form-label fw-semibold">Precio m√≠n ($)</label>
        <input 
          type="number" 
          name="precio_min" 
          class="form-control" 
          placeholder="0"
          value="{{ precio_min }}"
        >
      </div>
      <div class="col-md-2">
        <label class="form-label fw-semibold">Precio m√°x ($)</label>
        <input 
          type="number" 
          name="precio_max" 
          class="form-control" 
          placeholder="9999999"
          value="{{ precio_max }}"
        >
      </div>
      <div class="col-md-1 text-center">
        <button type="submit" class="btn btn-primary w-100">üîç</button>
      </div>
    </div>

    <!-- Bot√≥n de limpiar -->
    <div class="text-end mt-3">
      <a href="{% url 'cars:auto_list' %}" class="btn btn-outline-secondary">
        üîÑ Limpiar filtros
      </a>
    </div>
  </form>

  <!-- Bot√≥n para agregar auto -->
  <div class="text-end mb-3">
    <a href="{% url 'cars:auto_create' %}" class="btn btn-success">
      ‚ûï Agregar Auto
    </a>
  </div>

  <!-- Resultados -->
  {% if autos %}
  <div class="row">
    {% for auto in autos %}
    <div class="col-md-4 mb-4">
      <div class="card shadow-sm h-100">
        {% if auto.imagen %}
        <img src="{{ auto.imagen.url }}" class="card-img-top" alt="{{ auto.marca }}">
        {% endif %}
        <div class="card-body">
          <h5 class="card-title">{{ auto.marca }} {{ auto.modelo }}</h5>
          <p class="text-muted mb-1">A√±o: {{ auto.anio }}</p>
          <p class="text-muted mb-1">Precio: ${{ auto.precio }}</p>
          <p class="text-muted mb-2">Publicado por: {{ auto.user.username }}</p>
          <div class="d-flex justify-content-between">
            <a href="{% url 'cars:auto_detail' auto.pk %}" class="btn btn-outline-primary btn-sm">Ver</a>
            <a href="{% url 'cars:auto_edit' auto.pk %}" class="btn btn-outline-warning btn-sm">Editar</a>
            <a href="{% url 'cars:auto_delete' auto.pk %}" class="btn btn-outline-danger btn-sm">Eliminar</a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-center text-muted mt-4">No hay autos que coincidan con tu b√∫squeda.</p>
  {% endif %}
</div>
{% endblock %}
